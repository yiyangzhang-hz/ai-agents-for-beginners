<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "5cc6836626047aa055e8960c8484a7d0",
  "translation_date": "2025-08-29T10:53:29+00:00",
  "source_file": "11-agentic-protocols/code_samples/mcp-agents/README.md",
  "language_code": "mr"
}
-->
# MCP рд╡рд╛рдкрд░реВрди рдПрдЬрдВрдЯ-рдЯреВ-рдПрдЬрдВрдЯ рд╕рдВрд╡рд╛рдж рдкреНрд░рдгрд╛рд▓реА рддрдпрд╛рд░ рдХрд░рдгреЗ

> TL;DR - MCP рд╡рд░ Agent2Agent Communication рддрдпрд╛рд░ рдХрд░реВ рд╢рдХрддрд╛ рдХрд╛? рд╣реЛрдп!

MCP рдиреЗ "LLMs рд╕рд╛рдареА рд╕рдВрджрд░реНрдн рдкреНрд░рджрд╛рди рдХрд░рдгреЗ" рдпрд╛ рдореВрд│ рдЙрджреНрджрд┐рд╖реНрдЯрд╛рдкрд▓реАрдХрдбреЗ рд▓рдХреНрд╖рдгреАрдп рдкреНрд░рдЧрддреА рдХреЗрд▓реА рдЖрд╣реЗ. [resumable streams](https://modelcontextprotocol.io/docs/concepts/transports#resumability-and-redelivery), [elicitation](https://modelcontextprotocol.io/specification/2025-06-18/client/elicitation), [sampling](https://modelcontextprotocol.io/specification/2025-06-18/client/sampling), рдЖрдгрд┐ рд╕реВрдЪрдирд╛ ([progress](https://modelcontextprotocol.io/specification/2025-06-18/basic/utilities/progress) рдЖрдгрд┐ [resources](https://modelcontextprotocol.io/specification/2025-06-18/schema#resourceupdatednotification)) рдпрд╛рд╕рд╛рд░рдЦреНрдпрд╛ рдЕрд▓реАрдХрдбреАрд▓ рд╕реБрдзрд╛рд░рдгрд╛ MCP рд▓рд╛ рдЬрдЯрд┐рд▓ рдПрдЬрдВрдЯ-рдЯреВ-рдПрдЬрдВрдЯ рд╕рдВрд╡рд╛рдж рдкреНрд░рдгрд╛рд▓реА рддрдпрд╛рд░ рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдПрдХ рдордЬрдмреВрдд рдкрд╛рдпрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛рдд.

## рдПрдЬрдВрдЯ/рдЯреВрд▓ рд╡рд┐рд╖рдпреА рдЧреИрд░рд╕рдордЬ

рдЕрдзрд┐рдХрд╛рдзрд┐рдХ рд╡рд┐рдХрд╕рдХ рдПрдЬрдВрдЯрд┐рдХ рд╡рд░реНрддрди рдЕрд╕рд▓реЗрд▓реНрдпрд╛ рдЯреВрд▓реНрд╕рдЪрд╛ (рд▓рд╛рдВрдм рдХрд╛рд▓рд╛рд╡рдзреАрд╕рд╛рдареА рдЪрд╛рд▓рд╡рдгреЗ, рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рджрд░рдореНрдпрд╛рди рдЕрддрд┐рд░рд┐рдХреНрдд рдЗрдирдкреБрдЯрдЪреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдЕрд╕рдгреЗ рдЗ.) рд╢реЛрдз рдШреЗрдд рдЕрд╕рддрд╛рдирд╛, MCP рдореБрдЦреНрдпрддрдГ рдЕрдиреБрдкрдпреБрдХреНрдд рдЖрд╣реЗ рдЕрд╕рд╛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЧреИрд░рд╕рдордЬ рдЖрд╣реЗ рдХрд╛рд░рдг рддреНрдпрд╛рдЪреНрдпрд╛ рдЯреВрд▓реНрд╕ рдкреНрд░рд┐рдорд┐рдЯрд┐рд╡реНрд╣рдЪреНрдпрд╛ рд╕реБрд░реБрд╡рд╛рддреАрдЪреНрдпрд╛ рдЙрджрд╛рд╣рд░рдгрд╛рдВрдордзреНрдпреЗ рд╕рд╛рдзреНрдпрд╛ рд╡рд┐рдирдВрддреА-рдкреНрд░рддрд┐рд╕рд╛рдж рдкреЕрдЯрд░реНрдирд╡рд░ рд▓рдХреНрд╖ рдХреЗрдВрджреНрд░рд┐рдд рдХреЗрд▓реЗ рд╣реЛрддреЗ.

рд╣рд╛ рджреГрд╖реНрдЯрд┐рдХреЛрди рдЖрддрд╛ рдХрд╛рд▓рдмрд╛рд╣реНрдп рдЭрд╛рд▓рд╛ рдЖрд╣реЗ. MCP рд╕реНрдкреЗрд╕рд┐рдлрд┐рдХреЗрд╢рдирдордзреНрдпреЗ рдЧреЗрд▓реНрдпрд╛ рдХрд╛рд╣реА рдорд╣рд┐рдиреНрдпрд╛рдВрдд рд▓рдХреНрд╖рдгреАрдп рд╕реБрдзрд╛рд░рдгрд╛ рдХрд░рдгреНрдпрд╛рдд рдЖрд▓реНрдпрд╛ рдЖрд╣реЗрдд рдЬреНрдпрд╛рдореБрд│реЗ рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреНрдпрд╛ рдПрдЬрдВрдЯрд┐рдХ рд╡рд░реНрддрдирд╛рд╕рд╛рдареА рдЖрд╡рд╢реНрдпрдХ рдЕрд╕рд▓реЗрд▓реНрдпрд╛ рдХреНрд╖рдорддрд╛рдВрдЪреА рдкреВрд░реНрддрддрд╛ рд╣реЛрддреЗ:

- **Streaming & Partial Results**: рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рджрд░рдореНрдпрд╛рди рд░рд┐рдЕрд▓-рдЯрд╛рдЗрдо рдкреНрд░рдЧрддреА рдЕрджреНрдпрддрдиреЗ
- **Resumability**: рдбрд┐рд╕рдХрдиреЗрдХреНрд╢рдирдирдВрддрд░ рдХреНрд▓рд╛рдпрдВрдЯ рдкреБрдиреНрд╣рд╛ рдХрдиреЗрдХреНрдЯ рдХрд░реВ рд╢рдХрддреЛ рдЖрдгрд┐ рд╕реБрд░реВ рдареЗрд╡реВ рд╢рдХрддреЛ
- **Durability**: рд╕рд░реНрд╡реНрд╣рд░ рд░реАрд╕реНрдЯрд╛рд░реНрдЯ рдЭрд╛рд▓реНрдпрд╛рдирдВрддрд░рд╣реА рдирд┐рдХрд╛рд▓ рдЯрд┐рдХреВрди рд░рд╛рд╣рддрд╛рдд (рдЙрджрд╛. resource links рджреНрд╡рд╛рд░реЗ)
- **Multi-turn**: рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рджрд░рдореНрдпрд╛рди рд╕рдВрд╡рд╛рджрд╛рддреНрдордХ рдЗрдирдкреБрдЯ elicitation рдЖрдгрд┐ sampling рджреНрд╡рд╛рд░реЗ

рдпрд╛ рд╡реИрд╢рд┐рд╖реНрдЯреНрдпрд╛рдВрдЪрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реВрди рдЬрдЯрд┐рд▓ рдПрдЬрдВрдЯрд┐рдХ рдЖрдгрд┐ рдорд▓реНрдЯреА-рдПрдЬрдВрдЯ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╕рдХреНрд╖рдо рдХрд░рддрд╛ рдпреЗрддрд╛рдд, рдЬреЗ рд╕рд░реНрд╡ MCP рдкреНрд░реЛрдЯреЛрдХреЙрд▓рд╡рд░ рддреИрдирд╛рдд рдХреЗрд▓реЗ рдЬрд╛рддрд╛рдд.

рд╕рдВрджрд░реНрднрд╛рд╕рд╛рдареА, рдЖрдореНрд╣реА MCP рд╕рд░реНрд╡реНрд╣рд░рд╡рд░ рдЙрдкрд▓рдмреНрдз рдЕрд╕рд▓реЗрд▓реНрдпрд╛ "рдЯреВрд▓" рд▓рд╛ рдПрдЬрдВрдЯ рдореНрд╣рдгреВ. рдпрд╛рдЪрд╛ рдЕрд░реНрде рдЕрд╕рд╛ рдЖрд╣реЗ рдХреА MCP рдХреНрд▓рд╛рдпрдВрдЯ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рдХрд░рдгрд╛рд░реЗ рд╣реЛрд╕реНрдЯ рдЕреЕрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрд╕реНрддрд┐рддреНрд╡рд╛рдд рдЖрд╣реЗ рдЬреЗ MCP рд╕рд░реНрд╡реНрд╣рд░рд╢реА рд╕рддреНрд░ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддреЗ рдЖрдгрд┐ рдПрдЬрдВрдЯрд▓рд╛ рдХреЙрд▓ рдХрд░реВ рд╢рдХрддреЗ.

## MCP рдЯреВрд▓ "Agentic" рдХрд╕реЗ рдмрдирддреЗ?

рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреАрдордзреНрдпреЗ рдЬрд╛рдгреНрдпрд╛рдкреВрд░реНрд╡реА, рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреНрдпрд╛ рдПрдЬрдВрдЯреНрд╕рдирд╛ рд╕рдорд░реНрдерди рджреЗрдгреНрдпрд╛рд╕рд╛рдареА рдХреЛрдгрддреНрдпрд╛ рдкрд╛рдпрд╛рднреВрдд рд╕реБрд╡рд┐рдзрд╛ рдХреНрд╖рдорддрд╛рдВрдЪреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдЖрд╣реЗ рд╣реЗ рд╕реНрдкрд╖реНрдЯ рдХрд░реВрдпрд╛.

> рдЖрдореНрд╣реА рдПрдЬрдВрдЯрд▓рд╛ рдПрдХ рдЕрд╢реА рдЗрдХрд╛рдИ рдореНрд╣рдгреВрди рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реВ рдЬреА рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд╛рд▓рд╛рд╡рдзреАрд╕рд╛рдареА рд╕реНрд╡рд╛рдпрддреНрддрдкрдгреЗ рдХрд╛рд░реНрдп рдХрд░реВ рд╢рдХрддреЗ, рдЬрдЯрд┐рд▓ рдХрд╛рд░реНрдпреЗ рд╣рд╛рддрд╛рд│рдгреНрдпрд╛рд╕ рд╕рдХреНрд╖рдо рдЖрд╣реЗ рдЬреНрдпрд╛рд╕рд╛рдареА рдЕрдиреЗрдХ рд╕рдВрд╡рд╛рдж рдХрд┐рдВрд╡рд╛ рд░рд┐рдЕрд▓-рдЯрд╛рдЗрдо рдЕрднрд┐рдкреНрд░рд╛рдпрд╛рд╡рд░ рдЖрдзрд╛рд░рд┐рдд рд╕рдорд╛рдпреЛрдЬрди рдЖрд╡рд╢реНрдпрдХ рдЕрд╕реВ рд╢рдХрддреЗ.

### 1. Streaming & Partial Results

рдкрд╛рд░рдВрдкрд░рд┐рдХ рд╡рд┐рдирдВрддреА-рдкреНрд░рддрд┐рд╕рд╛рдж рдкреЕрдЯрд░реНрди рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреНрдпрд╛ рдХрд╛рд░реНрдпрд╛рдВрд╕рд╛рдареА рдХрд╛рд░реНрдп рдХрд░рдд рдирд╛рд╣реАрдд. рдПрдЬрдВрдЯреНрд╕рдирд╛ рдЦрд╛рд▓реАрд▓ рдЧреЛрд╖реНрдЯреА рдкреНрд░рджрд╛рди рдХрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ:

- рд░рд┐рдЕрд▓-рдЯрд╛рдЗрдо рдкреНрд░рдЧрддреА рдЕрджреНрдпрддрдиреЗ
- рдордзреНрдпрдо-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдирд┐рдХрд╛рд▓

**MCP рд╕рдорд░реНрдерди**: Resource update notifications рджреНрд╡рд╛рд░реЗ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдордзреНрдпрдо-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдирд┐рдХрд╛рд▓ рд╕рдХреНрд╖рдо рдХреЗрд▓реЗ рдЬрд╛рддрд╛рдд, рдЬрд░реА JSON-RPC рдЪреНрдпрд╛ 1:1 рд╡рд┐рдирдВрддреА/рдкреНрд░рддрд┐рд╕рд╛рдж рдореЙрдбреЗрд▓рд╢реА рд╕рдВрдШрд░реНрд╖ рдЯрд╛рд│рдгреНрдпрд╛рд╕рд╛рдареА рдХрд╛рд│рдЬреАрдкреВрд░реНрд╡рдХ рдбрд┐рдЭрд╛рдЗрди рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ.

| рд╡реИрд╢рд┐рд╖реНрдЯреНрдп                    | рдЙрдкрдпреЛрдЧ рдкреНрд░рдХрд░рдг                                                                                                                                                                       | MCP рд╕рдорд░реНрдерди                                                                                |
| -------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------ |
| рд░рд┐рдЕрд▓-рдЯрд╛рдЗрдо рдкреНрд░рдЧрддреА рдЕрджреНрдпрддрдиреЗ | рд╡рд╛рдкрд░рдХрд░реНрддрд╛ рдХреЛрдбрдмреЗрд╕ рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХрд╛рд░реНрдпрд╛рдЪреА рд╡рд┐рдирдВрддреА рдХрд░рддреЛ. рдПрдЬрдВрдЯ рдкреНрд░рдЧрддреА рд╕реНрдЯреНрд░реАрдо рдХрд░рддреЛ: "10% - Dependencies рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдд рдЖрд╣реЗ... 25% - TypeScript рдлрд╛рдЗрд▓реНрд╕ рд░реВрдкрд╛рдВрддрд░рд┐рдд рдХрд░рдд рдЖрд╣реЗ... 50% - Imports рдЕрджреНрдпрддрдирд┐рдд рдХрд░рдд рдЖрд╣реЗ..."          | тЬЕ рдкреНрд░рдЧрддреА рд╕реВрдЪрдирд╛                                                                  |
| рдордзреНрдпрдо-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдирд┐рдХрд╛рд▓            | "Generate a book" рдХрд╛рд░реНрдп рдордзреНрдпрдо-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдирд┐рдХрд╛рд▓ рд╕реНрдЯреНрд░реАрдо рдХрд░рддреЗ, рдЙрджрд╛., 1) рдХрдерд╛ рдЖрд░реНрдХ рд░реВрдкрд░реЗрд╖рд╛, 2) рдЕрдзреНрдпрд╛рдп рдпрд╛рджреА, 3) рдкреНрд░рддреНрдпреЗрдХ рдЕрдзреНрдпрд╛рдп рдкреВрд░реНрдг рдЭрд╛рд▓реНрдпрд╛рдкреНрд░рдорд╛рдгреЗ. рд╣реЛрд╕реНрдЯ рдХреЛрдгрддреНрдпрд╛рд╣реА рдЯрдкреНрдкреНрдпрд╛рд╡рд░ рддрдкрд╛рд╕реВ, рд░рджреНрдж рдХрд░реВ рдХрд┐рдВрд╡рд╛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░реВ рд╢рдХрддреЛ. | тЬЕ рд╕реВрдЪрдирд╛ "рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд" рдХреЗрд▓реНрдпрд╛ рдЬрд╛рдК рд╢рдХрддрд╛рдд рдЬреНрдпрд╛рдордзреНрдпреЗ рдордзреНрдпрдо-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдирд┐рдХрд╛рд▓ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдЖрд╣реЗрдд PR 383, 776 рдкреНрд░рд╕реНрддрд╛рд╡ рдкрд╣рд╛ |

<div align="center" style="font-style: italic; font-size: 0.95em; margin-bottom: 0.5em;">
<strong>рдЪрд┐рддреНрд░ 1:</strong> MCP рдПрдЬрдВрдЯ рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреНрдпрд╛ рдХрд╛рд░реНрдпрд╛рджрд░рдореНрдпрд╛рди рд╣реЛрд╕реНрдЯ рдЕреЕрдкреНрд▓рд┐рдХреЗрд╢рдирд▓рд╛ рд░рд┐рдЕрд▓-рдЯрд╛рдЗрдо рдкреНрд░рдЧрддреА рдЕрджреНрдпрддрдиреЗ рдЖрдгрд┐ рдордзреНрдпрдо-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдирд┐рдХрд╛рд▓ рдХрд╕реЗ рд╕реНрдЯреНрд░реАрдо рдХрд░рддреЛ рд╣реЗ рджрд░реНрд╢рд╡рд┐рдгрд╛рд░реЗ рд╣реЗ рдЖрдХреГрддреА рдЖрд╣реЗ, рдЬреНрдпрд╛рдореБрд│реЗ рд╡рд╛рдкрд░рдХрд░реНрддреНрдпрд╛рд▓рд╛ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рд░рд┐рдЕрд▓-рдЯрд╛рдЗрдордордзреНрдпреЗ рдореЙрдирд┐рдЯрд░ рдХрд░рдгреНрдпрд╛рд╕ рд╕рдХреНрд╖рдо рд╣реЛрддреЗ.
</div>

```mermaid
sequenceDiagram
    participant User
    participant Host as Host App<br/>(MCP Client)
    participant Server as MCP Server<br/>(Agent Tool)

    User->>Host: Start long task
    Host->>Server: Call agent_tool()

    loop Progress Updates
        Server-->>Host: Progress + partial results
        Host-->>User: Stream updates
    end

    Server-->>Host: тЬЕ Final result
    Host-->>User: Complete
```

### 2. Resumability

рдПрдЬрдВрдЯреНрд╕рдирд╛ рдиреЗрдЯрд╡рд░реНрдХ рд╡реНрдпрддреНрдпрдпрд╛рдВрдЪрд╛ рд╕реМрдореНрдпрдкрдгреЗ рд╕рд╛рдордирд╛ рдХрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ:

- рдбрд┐рд╕рдХрдиреЗрдХреНрд╢рдирдирдВрддрд░ рдкреБрдиреНрд╣рд╛ рдХрдиреЗрдХреНрдЯ рдХрд░рд╛
- рдЬрд┐рдереЗ рдерд╛рдВрдмрд▓реЗ рд╣реЛрддреЗ рддрд┐рдереВрди рд╕реБрд░реВ рдареЗрд╡рд╛ (message redelivery)

**MCP рд╕рдорд░реНрдерди**: MCP StreamableHTTP transport рд╕рддреНрд░ IDs рдЖрдгрд┐ рд╢реЗрд╡рдЯрдЪреНрдпрд╛ рдЗрд╡реНрд╣реЗрдВрдЯ IDs рд╕рд╣ рд╕рддреНрд░ рдкреБрдирд░рд╛рд░рдВрдн рдЖрдгрд┐ рд╕рдВрджреЗрд╢ рдкреБрдирд░реНрдкреНрд░реЗрд╖рдг рд╕рдорд░реНрдерди рдХрд░рддреЗ. рдпреЗрдереЗ рдорд╣рддреНрддреНрд╡рд╛рдЪреА рдЧреЛрд╖реНрдЯ рдореНрд╣рдгрдЬреЗ рд╕рд░реНрд╡реНрд╣рд░рдиреЗ EventStore рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рдХрд░рдгреЗ рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ рдЬреЗ рдХреНрд▓рд╛рдпрдВрдЯ рдкреБрдирд░реНрдХрдиреЗрдХреНрд╢рдирд╡рд░ рдЗрд╡реНрд╣реЗрдВрдЯ рд░реАрдкреНрд▓реЗ рд╕рдХреНрд╖рдо рдХрд░рддреЗ.  
рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдкреНрд░рд╕реНрддрд╛рд╡ (PR #975) transport-agnostic resumable streams рдПрдХреНрд╕рдкреНрд▓реЛрд░ рдХрд░рддреЛ рд╣реЗ рд▓рдХреНрд╖рд╛рдд рдШреНрдпрд╛.

| рд╡реИрд╢рд┐рд╖реНрдЯреНрдп      | рдЙрдкрдпреЛрдЧ рдкреНрд░рдХрд░рдг                                                                                                                                                   | MCP рд╕рдорд░реНрдерди                                                                |
| ------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------- |
| Resumability | рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреНрдпрд╛ рдХрд╛рд░реНрдпрд╛рджрд░рдореНрдпрд╛рди рдХреНрд▓рд╛рдпрдВрдЯ рдбрд┐рд╕рдХрдиреЗрдХреНрдЯ рд╣реЛрддреЛ. рдкреБрдирд░реНрдХрдиреЗрдХреНрд╢рди рдЭрд╛рд▓реНрдпрд╛рд╡рд░, рд╕рддреНрд░ рдкреБрдиреНрд╣рд╛ рд╕реБрд░реВ рд╣реЛрддреЗ рдЖрдгрд┐ рдЧрдорд╛рд╡рд▓реЗрд▓реЗ рдЗрд╡реНрд╣реЗрдВрдЯ рд░реАрдкреНрд▓реЗ рдХреЗрд▓реЗ рдЬрд╛рддрд╛рдд, рдЬрд┐рдереЗ рдерд╛рдВрдмрд▓реЗ рд╣реЛрддреЗ рддрд┐рдереВрди рдЕрдЦрдВрдбрдкрдгреЗ рд╕реБрд░реВ рдареЗрд╡рддреЗ. | тЬЕ StreamableHTTP transport рд╕рддреНрд░ IDs, рдЗрд╡реНрд╣реЗрдВрдЯ рд░реАрдкреНрд▓реЗ, рдЖрдгрд┐ EventStore рд╕рд╣ |

<div align="center" style="font-style: italic; font-size: 0.95em; margin-bottom: 0.5em;">
<strong>рдЪрд┐рддреНрд░ 2:</strong> MCP рдЪреНрдпрд╛ StreamableHTTP transport рдЖрдгрд┐ рдЗрд╡реНрд╣реЗрдВрдЯ рд╕реНрдЯреЛрдЕрд░ рдХрд╕реЗ рдЕрдЦрдВрдб рд╕рддреНрд░ рдкреБрдирд░рд╛рд░рдВрдн рд╕рдХреНрд╖рдо рдХрд░рддрд╛рдд рд╣реЗ рджрд░реНрд╢рд╡рд┐рдгрд╛рд░реЗ рд╣реЗ рдЖрдХреГрддреА рдЖрд╣реЗ: рдЬрд░ рдХреНрд▓рд╛рдпрдВрдЯ рдбрд┐рд╕рдХрдиреЗрдХреНрдЯ рдЭрд╛рд▓рд╛, рддрд░ рддреЛ рдкреБрдиреНрд╣рд╛ рдХрдиреЗрдХреНрдЯ рдХрд░реВ рд╢рдХрддреЛ рдЖрдгрд┐ рдЧрдорд╛рд╡рд▓реЗрд▓реЗ рдЗрд╡реНрд╣реЗрдВрдЯ рд░реАрдкреНрд▓реЗ рдХрд░реВ рд╢рдХрддреЛ, рдкреНрд░рдЧрддреА рди рдЧрдорд╛рд╡рддрд╛ рдХрд╛рд░реНрдп рд╕реБрд░реВ рдареЗрд╡реВ рд╢рдХрддреЛ.
</div>

```mermaid
sequenceDiagram
    participant User
    participant Host as Host App<br/>(MCP Client)
    participant Server as MCP Server<br/>(Agent Tool)
    participant Store as Event Store

    User->>Host: Start task
    Host->>Server: Call tool [session: abc123]
    Server->>Store: Save events

    Note over Host,Server: ЁЯТе Connection lost

    Host->>Server: Reconnect [session: abc123]
    Store-->>Server: Replay events
    Server-->>Host: Catch up + continue
    Host-->>User: тЬЕ Complete
```

### 3. Durability

рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдПрдЬрдВрдЯреНрд╕рдирд╛ рдЯрд┐рдХрд╛рдК рд╕реНрдерд┐рддреА рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ:

- рд╕рд░реНрд╡реНрд╣рд░ рд░реАрд╕реНрдЯрд╛рд░реНрдЯ рдЭрд╛рд▓реНрдпрд╛рдирдВрддрд░рд╣реА рдирд┐рдХрд╛рд▓ рдЯрд┐рдХреВрди рд░рд╛рд╣рддрд╛рдд
- рд╕реНрдЯреЗрдЯрд╕ рдмрд╛рд╣реЗрд░реВрди рдорд┐рд│рд╡рддрд╛ рдпреЗрддреЛ
- рд╕рддреНрд░рд╛рдВрдордзреНрдпреЗ рдкреНрд░рдЧрддреА рдЯреНрд░реЕрдХрд┐рдВрдЧ

**MCP рд╕рдорд░реНрдерди**: MCP рдЖрддрд╛ рдЯреВрд▓ рдХреЙрд▓рд╕рд╛рдареА Resource link return рдкреНрд░рдХрд╛рд░ рд╕рдорд░реНрдерди рдХрд░рддреЗ. рдЖрдЬ, рдПрдХ рд╕рдВрднрд╛рд╡реНрдп рдкреЕрдЯрд░реНрди рдореНрд╣рдгрдЬреЗ рдЯреВрд▓ рдбрд┐рдЭрд╛рдЗрди рдХрд░рдгреЗ рдЬреЗ рдПрдХ resource рддрдпрд╛рд░ рдХрд░рддреЗ рдЖрдгрд┐ рддреНрд╡рд░рд┐рдд resource link рдкрд░рдд рдХрд░рддреЗ. рдЯреВрд▓ рдкрд╛рд░реНрд╢реНрд╡рднреВрдореАрдд рдХрд╛рд░реНрдпрд╛рд╡рд░ рд▓рдХреНрд╖ рдХреЗрдВрджреНрд░рд┐рдд рдХрд░реВ рд╢рдХрддреЗ рдЖрдгрд┐ resource рдЕрджреНрдпрддрдирд┐рдд рдХрд░реВ рд╢рдХрддреЗ. рдпрд╛рдЙрд▓рдЯ, рдХреНрд▓рд╛рдпрдВрдЯ resource рдЪреНрдпрд╛ рд╕реНрдерд┐рддреАрдЪреА рддрдкрд╛рд╕рдгреА рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА рдирд┐рд╡рдб рдХрд░реВ рд╢рдХрддреЛ рдЬреЗрдгреЗрдХрд░реВрди resource рдЕрджреНрдпрддрдирд╛рдВрд╡рд░ рдЖрдзрд╛рд░рд┐рдд рдордзреНрдпрдо-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдХрд┐рдВрд╡рд╛ рдкреВрд░реНрдг рдирд┐рдХрд╛рд▓ рдорд┐рд│рддреАрд▓ рдХрд┐рдВрд╡рд╛ resource рдЕрджреНрдпрддрдирд╛рдВрд╕рд╛рдареА рд╕рджрд╕реНрдпрддрд╛ рдШреЗрдК рд╢рдХрддреЛ.

рдпреЗрдереЗ рдПрдХ рдорд░реНрдпрд╛рджрд╛ рдЖрд╣реЗ рдХреА resource polling рдХрд┐рдВрд╡рд╛ рдЕрджреНрдпрддрдирд╛рдВрд╕рд╛рдареА рд╕рджрд╕реНрдпрддрд╛ рдШреЗрдгреЗ рд╕реНрдХреЗрд▓рд╡рд░ рдкрд░рд┐рдгрд╛рдорд╛рдВрд╕рд╣ рд╕рдВрд╕рд╛рдзрдиреЗ рд╡рд╛рдкрд░реВ рд╢рдХрддреЗ. рд╕рд╛рдореБрджрд╛рдпрд┐рдХ рдкреНрд░рд╕реНрддрд╛рд╡ (рдпрд╛рдордзреНрдпреЗ #992 рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдЖрд╣реЗ) рд╕рд░реНрд╡реНрд╣рд░ рдХреНрд▓рд╛рдпрдВрдЯ/рд╣реЛрд╕реНрдЯ рдЕреЕрдкреНрд▓рд┐рдХреЗрд╢рдирд▓рд╛ рдЕрджреНрдпрддрдирд╛рдВрдЪреА рд╕реВрдЪрдирд╛ рджреЗрдгреНрдпрд╛рд╕рд╛рдареА рдХреЙрд▓ рдХрд░реВ рд╢рдХрддреЛ рдЕрд╢рд╛ рд╡реЗрдмрд╣реБрдХреНрд╕ рдХрд┐рдВрд╡рд╛ рдЯреНрд░рд┐рдЧрд░реНрд╕ рд╕рдорд╛рд╡рд┐рд╖реНрдЯ рдХрд░рдгреНрдпрд╛рдЪреА рд╢рдХреНрдпрддрд╛ рдПрдХреНрд╕рдкреНрд▓реЛрд░ рдХрд░рддреЛ.

| рд╡реИрд╢рд┐рд╖реНрдЯреНрдп    | рдЙрдкрдпреЛрдЧ рдкреНрд░рдХрд░рдг                                                                                                                                        | MCP рд╕рдорд░реНрдерди                                                        |
| ---------- | ----------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------ |
| Durability | рдбреЗрдЯрд╛ рдорд╛рдЗрдЧреНрд░реЗрд╢рди рдХрд╛рд░реНрдпрд╛рджрд░рдореНрдпрд╛рди рд╕рд░реНрд╡реНрд╣рд░ рдХреНрд░реЕрд╢ рд╣реЛрддреЛ. рдирд┐рдХрд╛рд▓ рдЖрдгрд┐ рдкреНрд░рдЧрддреА рд░реАрд╕реНрдЯрд╛рд░реНрдЯ рдЯрд┐рдХреВрди рд░рд╛рд╣рддреЗ, рдХреНрд▓рд╛рдпрдВрдЯ рд╕реНрдерд┐рддреА рддрдкрд╛рд╕реВ рд╢рдХрддреЛ рдЖрдгрд┐ рдЯрд┐рдХрд╛рдК resource рд╡рд░реВрди рд╕реБрд░реВ рдареЗрд╡реВ рд╢рдХрддреЛ. | тЬЕ Resource links рдЯрд┐рдХрд╛рдК рд╕реНрдЯреЛрд░реЗрдЬ рдЖрдгрд┐ рд╕реНрдерд┐рддреА рд╕реВрдЪрдирд╛ рд╕рд╣ |

рдЖрдЬ, рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдкреЕрдЯрд░реНрди рдореНрд╣рдгрдЬреЗ рдЯреВрд▓ рдбрд┐рдЭрд╛рдЗрди рдХрд░рдгреЗ рдЬреЗ рдПрдХ resource рддрдпрд╛рд░ рдХрд░рддреЗ рдЖрдгрд┐ рддреНрд╡рд░рд┐рдд resource link рдкрд░рдд рдХрд░рддреЗ. рдЯреВрд▓ рдкрд╛рд░реНрд╢реНрд╡рднреВрдореАрдд рдХрд╛рд░реНрдпрд╛рд╡рд░ рд▓рдХреНрд╖ рдХреЗрдВрджреНрд░рд┐рдд рдХрд░реВ рд╢рдХрддреЗ, resource рд╕реВрдЪрдирд╛ рдЬрд╛рд░реА рдХрд░реВ рд╢рдХрддреЗ рдЬреНрдпрд╛рдореБрд│реЗ рдкреНрд░рдЧрддреА рдЕрджреНрдпрддрдиреЗ рдХрд┐рдВрд╡рд╛ рдордзреНрдпрдо-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдирд┐рдХрд╛рд▓ рдорд┐рд│рддрд╛рдд, рдЖрдгрд┐ рдЖрд╡рд╢реНрдпрдХрддреЗрдиреБрд╕рд╛рд░ resource рдордзреАрд▓ рд╕рд╛рдордЧреНрд░реА рдЕрджреНрдпрддрдирд┐рдд рдХрд░реВ рд╢рдХрддреЗ.

<div align="center" style="font-style: italic; font-size: 0.95em; margin-bottom: 0.5em;">
<strong>рдЪрд┐рддреНрд░ 3:</strong> MCP рдПрдЬрдВрдЯреНрд╕ рдЯрд┐рдХрд╛рдК resources рдЖрдгрд┐ рд╕реНрдерд┐рддреА рд╕реВрдЪрдирд╛ рдХрд╕реЗ рд╡рд╛рдкрд░рддрд╛рдд рд╣реЗ рджрд░реНрд╢рд╡рд┐рдгрд╛рд░реЗ рд╣реЗ рдЖрдХреГрддреА рдЖрд╣реЗ, рдЬреНрдпрд╛рдореБрд│реЗ рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдХрд╛рд░реНрдп рд╕рд░реНрд╡реНрд╣рд░ рд░реАрд╕реНрдЯрд╛рд░реНрдЯ рдЯрд┐рдХреВрди рд░рд╛рд╣рддреЗ, рдХреНрд▓рд╛рдпрдВрдЯрд▓рд╛ рдкреНрд░рдЧрддреА рддрдкрд╛рд╕рдгреНрдпрд╛рд╕ рдЖрдгрд┐ рдЕрдкрдпрд╢рд╛рдирдВрддрд░рд╣реА рдирд┐рдХрд╛рд▓ рдорд┐рд│рд╡рд┐рдгреНрдпрд╛рд╕ рдЕрдиреБрдорддреА рджреЗрддреЗ.
</div>

```mermaid
sequenceDiagram
    participant User
    participant Host as Host App<br/>(MCP Client)
    participant Server as MCP Server<br/>(Agent Tool)
    participant DB as Persistent Storage

    User->>Host: Start task
    Host->>Server: Call tool
    Server->>DB: Create resource + updates
    Server-->>Host: ЁЯФЧ Resource link

    Note over Server: ЁЯТе Server restart

    User->>Host: Check status
    Host->>Server: Get resource
    Server->>DB: Load state
    Server-->>Host: Current progress
    Server->>DB: Complete + notify
    Host-->>User: тЬЕ Complete
```

### 4. Multi-Turn Interactions

рдПрдЬрдВрдЯреНрд╕рдирд╛ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рджрд░рдореНрдпрд╛рди рдЕрддрд┐рд░рд┐рдХреНрдд рдЗрдирдкреБрдЯ рдЖрд╡рд╢реНрдпрдХ рдЕрд╕рддреЗ:

- рдорд╛рдирд╡реА рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдХрд┐рдВрд╡рд╛ рдорд╛рдиреНрдпрддрд╛
- рдЬрдЯрд┐рд▓ рдирд┐рд░реНрдгрдпрд╛рдВрд╕рд╛рдареА AI рд╕рд╣рд╛рдпреНрдп
- рдбрд╛рдпрдиреЕрдорд┐рдХ рдкреЕрд░рд╛рдореАрдЯрд░ рд╕рдорд╛рдпреЛрдЬрди

**MCP рд╕рдорд░реНрдерди**: рдкреВрд░реНрдгрдкрдгреЗ sampling (AI рдЗрдирдкреБрдЯрд╕рд╛рдареА) рдЖрдгрд┐ elicitation (рдорд╛рдирд╡реА рдЗрдирдкреБрдЯрд╕рд╛рдареА) рджреНрд╡рд╛рд░реЗ рд╕рдорд░реНрдерд┐рдд.

| рд╡реИрд╢рд┐рд╖реНрдЯреНрдп                 | рдЙрдкрдпреЛрдЧ рдкреНрд░рдХрд░рдг                                                                                                                                     | MCP рд╕рдорд░реНрдерди                                           |
| ----------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------- |
| Multi-Turn Interactions | рдЯреНрд░реЕрд╡реНрд╣рд▓ рдмреБрдХрд┐рдВрдЧ рдПрдЬрдВрдЯ рд╡рд╛рдкрд░рдХрд░реНрддреНрдпрд╛рдХрдбреВрди рдХрд┐рдВрдорддреАрдЪреА рдкреБрд╖реНрдЯреА рдорд╛рдЧрддреЛ, рдирдВрддрд░ рдмреБрдХрд┐рдВрдЧ рд╡реНрдпрд╡рд╣рд╛рд░ рдкреВрд░реНрдг рдХрд░рдгреНрдпрд╛рдкреВрд░реНрд╡реА рдЯреНрд░реЕрд╡реНрд╣рд▓ рдбреЗрдЯрд╛ рд╕рд╛рд░рд╛рдВрд╢рд┐рдд рдХрд░рдгреНрдпрд╛рд╕рд╛рдареА AI рд▓рд╛ рд╡рд┐рдЪрд╛рд░рддреЛ. | тЬЕ рдорд╛рдирд╡реА рдЗрдирдкреБрдЯрд╕рд╛рдареА elicitation, AI рдЗрдирдкреБрдЯрд╕рд╛рдареА sampling |

<div align="center" style="font-style: italic; font-size: 0.95em; margin-bottom: 0.5em;">
<strong>рдЪрд┐рддреНрд░ 4:</strong> MCP рдПрдЬрдВрдЯреНрд╕ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рджрд░рдореНрдпрд╛рди рдорд╛рдирд╡реА рдЗрдирдкреБрдЯ рд╕рдВрд╡рд╛рджрд╛рддреНрдордХрдкрдгреЗ рдХрд╕реЗ elicitation рдХрд░реВ рд╢рдХрддрд╛рдд рдХрд┐рдВрд╡рд╛ рдЬрдЯрд┐рд▓, рдорд▓реНрдЯреА-рдЯрд░реНрди рд╡рд░реНрдХрдлреНрд▓реЛ рдЬрд╕реЗ рдХреА рдкреБрд╖реНрдЯреАрдХрд░рдгреЗ рдЖрдгрд┐ рдбрд╛рдпрдиреЕрдорд┐рдХ рдирд┐рд░реНрдгрдп рдШреЗрдгреЗ рдпрд╛рд╕рд╛рдареА AI рд╕рд╣рд╛рдпреНрдп рдХрд╕реЗ рдорд╛рдЧреВ рд╢рдХрддрд╛рдд рд╣реЗ рджрд░реНрд╢рд╡рд┐рдгрд╛рд░реЗ рд╣реЗ рдЖрдХреГрддреА рдЖрд╣реЗ.
</div>

```mermaid
sequenceDiagram
    participant User
    participant Host as Host App<br/>(MCP Client)
    participant Server as MCP Server<br/>(Agent Tool)

    User->>Host: Book flight
    Host->>Server: Call travel_agent

    Server->>Host: Elicitation: "Confirm $500?"
    Note over Host: Elicitation callback (if available)
    Host->>User: ЁЯТ░ Confirm price?
    User->>Host: "Yes"
    Host->>Server: Confirmed

    Server->>Host: Sampling: "Summarize data"
    Note over Host: AI callback (if available)
    Host->>Server: Report summary

    Server->>Host: тЬЕ Flight booked
```

## MCP рд╡рд░ рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдПрдЬрдВрдЯреНрд╕ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рдХрд░рдгреЗ - рдХреЛрдб рд╡рд┐рд╣рдВрдЧрд╛рд╡рд▓реЛрдХрди

рдпрд╛ рд▓реЗрдЦрд╛рдЪрд╛ рднрд╛рдЧ рдореНрд╣рдгреВрди, рдЖрдореНрд╣реА MCP Python SDK рд╡рд╛рдкрд░реВрди StreamableHTTP transport рд╕рд╣ рд╕рддреНрд░ рдкреБрдирд░рд╛рд░рдВрдн рдЖрдгрд┐ рд╕рдВрджреЗрд╢ рдкреБрдирд░реНрдкреНрд░реЗрд╖рдгрд╛рд╕рд╛рдареА рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдПрдЬрдВрдЯреНрд╕ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рдХрд░рдгрд╛рд░реЗ [рдХреЛрдб рд░рд┐рдкреЙрдЭрд┐рдЯрд░реА](https://github.com/victordibia/ai-tutorials/tree/main/MCP%20Agents) рдкреНрд░рджрд╛рди рдХрд░рддреЛ. рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА MCP рдХреНрд╖рдорддрд╛рдВрдЪрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реВрди рдЬрдЯрд┐рд▓ рдПрдЬрдВрдЯрд╕рд╛рд░рдЦреЗ рд╡рд░реНрддрди рд╕рдХреНрд╖рдо рдХрд░рдгреНрдпрд╛рдЪреЗ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддреЗ.

рд╡рд┐рд╢реЗрд╖рддрдГ, рдЖрдореНрд╣реА рджреЛрди рдкреНрд░рд╛рдердорд┐рдХ рдПрдЬрдВрдЯ рдЯреВрд▓реНрд╕рд╕рд╣ рд╕рд░реНрд╡реНрд╣рд░ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рд┐рддреЛ:

- **Travel Agent** - elicitation рджреНрд╡рд╛рд░реЗ рдХрд┐рдВрдорддреАрдЪреА рдкреБрд╖реНрдЯреАрдХрд░рдгрд╛рд╕рд╣ рдЯреНрд░реЕрд╡реНрд╣рд▓ рдмреБрдХрд┐рдВрдЧ рд╕реЗрд╡рд╛ рдЕрдиреБрдХрд░рдг рдХрд░рддреЗ
- **Research Agent** - sampling рджреНрд╡рд╛рд░реЗ AI-рд╕рд╣рд╛рдпреНрдпрд┐рдд рд╕рд╛рд░рд╛рдВрд╢рд╛рдВрд╕рд╣ рд╕рдВрд╢реЛрдзрди рдХрд╛рд░реНрдпреЗ рдХрд░рддреЗ

рджреЛрдиреНрд╣реА рдПрдЬрдВрдЯреНрд╕ рд░рд┐рдЕрд▓-рдЯрд╛рдЗрдо рдкреНрд░рдЧрддреА рдЕрджреНрдпрддрдиреЗ, рд╕рдВрд╡рд╛рджрд╛рддреНрдордХ рдкреБрд╖реНрдЯреАрдХрд░рдгреЗ, рдЖрдгрд┐ рдкреВрд░реНрдг рд╕рддреНрд░ рдкреБрдирд░рд╛рд░рдВрдн рдХреНрд╖рдорддрд╛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛рдд.

### рдореБрдЦреНрдп рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рд╕рдВрдХрд▓реНрдкрдирд╛

рдЦрд╛рд▓реАрд▓ рд╡рд┐рднрд╛рдЧ рдкреНрд░рддреНрдпреЗрдХ рдХреНрд╖рдорддреЗрд╕рд╛рдареА рд╕рд░реНрд╡реНрд╣рд░-рд╕рд╛рдЗрдб рдПрдЬрдВрдЯ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рдЖрдгрд┐ рдХреНрд▓рд╛рдпрдВрдЯ-рд╕рд╛рдЗрдб рд╣реЛрд╕реНрдЯ рд╣рд╛рддрд╛рд│рдгреА рджрд░реНрд╢рд╡рд┐рддрд╛рдд:

#### Streaming & Progress Updates - рд░рд┐рдЕрд▓-рдЯрд╛рдЗрдо рдХрд╛рд░реНрдп рд╕реНрдерд┐рддреА

Streaming рдПрдЬрдВрдЯреНрд╕рдирд╛ рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреНрдпрд╛ рдХрд╛рд░реНрдпрд╛рджрд░рдореНрдпрд╛рди рд░рд┐рдЕрд▓-рдЯрд╛рдЗрдо рдкреНрд░рдЧрддреА рдЕрджреНрдпрддрдиреЗ рдкреНрд░рджрд╛рди рдХрд░рдгреНрдпрд╛рд╕ рд╕рдХреНрд╖рдо рдХрд░рддреЗ, рд╡рд╛рдкрд░рдХрд░реНрддреНрдпрд╛рдВрдирд╛ рдХрд╛рд░реНрдп рд╕реНрдерд┐рддреА рдЖрдгрд┐ рдордзреНрдпрдо-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдирд┐рдХрд╛рд▓рд╛рдВрдЪреА рдорд╛рд╣рд┐рддреА рдареЗрд╡рддреЗ.

**рд╕рд░реНрд╡реНрд╣рд░ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА (рдПрдЬрдВрдЯ рдкреНрд░рдЧрддреА рд╕реВрдЪрдирд╛ рдкрд╛рдард╡рддреЛ):**

```python
# From server/server.py - Travel agent sending progress updates
for i, step in enumerate(steps):
    await ctx.session.send_progress_notification(
        progress_token=ctx.request_id,
        progress=i * 25,
        total=100,
        message=step,
        related_request_id=str(ctx.request_id)
    )
    await anyio.sleep(2)  # Simulate work

# Alternative: Log messages for detailed step-by-step updates
await ctx.session.send_log_message(
    level="info",
    data=f"Processing step {current_step}/{steps} ({progress_percent}%)",
    logger="long_running_agent",
    related_request_id=ctx.request_id,
)
```

**рдХреНрд▓рд╛рдпрдВрдЯ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА (рд╣реЛрд╕реНрдЯ рдкреНрд░рдЧрддреА рдЕрджреНрдпрддрдиреЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЛ):**

```python
# From client/client.py - Client handling real-time notifications
async def message_handler(message) -> None:
    if isinstance(message, types.ServerNotification):
        if isinstance(message.root, types.LoggingMessageNotification):
            console.print(f"ЁЯУб [dim]{message.root.params.data}[/dim]")
        elif isinstance(message.root, types.ProgressNotification):
            progress = message.root.params
            console.print(f"ЁЯФД [yellow]{progress.message} ({progress.progress}/{progress.total})[/yellow]")

# Register message handler when creating session
async with ClientSession(
    read_stream, write_stream,
    message_handler=message_handler
) as session:
```

#### Elicitation - рд╡рд╛рдкрд░рдХрд░реНрддреНрдпрд╛рдЪрд╛ рдЗрдирдкреБрдЯ рдорд╛рдЧрдгреЗ

Elicitation рдПрдЬрдВрдЯреНрд╕рдирд╛ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рджрд░рдореНрдпрд╛рди рд╡рд╛рдкрд░рдХрд░реНрддреНрдпрд╛рдЪрд╛ рдЗрдирдкреБрдЯ рдорд╛рдЧрдгреНрдпрд╛рд╕ рд╕рдХреНрд╖рдо рдХрд░рддреЗ. рд╣реЗ рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреНрдпрд╛ рдХрд╛рд░реНрдпрд╛рджрд░рдореНрдпрд╛рди рдкреБрд╖реНрдЯреАрдХрд░рдгреЗ, рд╕реНрдкрд╖реНрдЯреАрдХрд░рдгреЗ, рдХрд┐рдВрд╡рд╛ рдорд╛рдиреНрдпрддрд╛ рдпрд╛рд╕рд╛рдареА рдЖрд╡рд╢реНрдпрдХ рдЖрд╣реЗ.

**рд╕рд░реНрд╡реНрд╣рд░ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА (рдПрдЬрдВрдЯ рдкреБрд╖реНрдЯреАрдХрд░рдг рдорд╛рдЧрддреЛ):**

```python
# From server/server.py - Travel agent requesting price confirmation
elicit_result = await ctx.session.elicit(
    message=f"Please confirm the estimated price of $1200 for your trip to {destination}",
    requestedSchema=PriceConfirmationSchema.model_json_schema(),
    related_request_id=ctx.request_id,
)

if elicit_result and elicit_result.action == "accept":
    # Continue with booking
    logger.info(f"User confirmed price: {elicit_result.content}")
elif elicit_result and elicit_result.action == "decline":
    # Cancel the booking
    booking_cancelled = True
```

**рдХреНрд▓рд╛рдпрдВрдЯ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА (рд╣реЛрд╕реНрдЯ elicitation callback рдкреНрд░рджрд╛рди рдХрд░рддреЛ):**

```python
# From client/client.py - Client handling elicitation requests
async def elicitation_callback(context, params):
    console.print(f"ЁЯТм Server is asking for confirmation:")
    console.print(f"   {params.message}")

    response = console.input("Do you accept? (y/n): ").strip().lower()

    if response in ['y', 'yes']:
        return types.ElicitResult(
            action="accept",
            content={"confirm": True, "notes": "Confirmed by user"}
        )
    else:
        return types.ElicitResult(
            action="decline",
            content={"confirm": False, "notes": "Declined by user"}
        )

# Register the callback when creating the session
async with ClientSession(
    read_stream, write_stream,
    elicitation_callback=elicitation_callback
) as session:
```

#### Sampling - AI рд╕рд╣рд╛рдпреНрдп рдорд╛рдЧрдгреЗ

Sampling рдПрдЬрдВрдЯреНрд╕рдирд╛ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рджрд░рдореНрдпрд╛рди рдЬрдЯрд┐рд▓ рдирд┐рд░реНрдгрдп рдХрд┐рдВрд╡рд╛ рд╕рд╛рдордЧреНрд░реА рдирд┐рд░реНрдорд┐рддреАрд╕рд╛рдареА LLM рд╕рд╣рд╛рдпреНрдп рдорд╛рдЧрдгреНрдпрд╛рд╕ рд╕рдХреНрд╖рдо рдХрд░рддреЗ. рд╣реЗ рд╣рд╛рдпрдмреНрд░рд┐рдб рдорд╛рдирд╡реА-AI рд╡рд░реНрдХрдлреНрд▓реЛ рд╕рдХреНрд╖рдо рдХрд░рддреЗ.

**рд╕рд░реНрд╡реНрд╣рд░ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА (рдПрдЬрдВрдЯ AI рд╕рд╣рд╛рдпреНрдп рдорд╛рдЧрддреЛ):**

```python
# From server/server.py - Research agent requesting AI summary
sampling_result = await ctx.session.create_message(
    messages=[
        SamplingMessage(
            role="user",
            content=TextContent(type="text", text=f"Please summarize the key findings for research on: {topic}")
        )
    ],
    max_tokens=100,
    related_request_id=ctx.request_id,
)

if sampling_result and sampling_result.content:
    if sampling_result.content.type == "text":
        sampling_summary = sampling_result.content.text
        logger.info(f"Received sampling summary: {sampling_summary}")
```

**рдХреНрд▓рд╛рдпрдВрдЯ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА (рд╣реЛрд╕реНрдЯ sampling callback рдкреНрд░рджрд╛рди рдХрд░рддреЛ):**

```python
# From client/client.py - Client handling sampling requests
async def sampling_callback(context, params):
    message_text = params.messages[0].content.text if params.messages else 'No message'
    console.print(f"ЁЯза Server requested sampling: {message_text}")

    # In a real application, this could call an LLM API
    # For demo purposes, we provide a mock response
    mock_response = "Based on current research, MCP has evolved significantly..."

    return types.CreateMessageResult(
        role="assistant",
        content=types.TextContent(type="text", text=mock_response),
        model="interactive-client",
        stopReason="endTurn"
    )

# Register the callback when creating the session
async with ClientSession(
    read_stream, write_stream,
    sampling_callback=sampling_callback,
    elicitation_callback=elicitation_callback
) as session:
```

#### Resumability - рдбрд┐рд╕рдХрдиреЗрдХреНрд╢рди рджрд░рдореНрдпрд╛рди рд╕рддреНрд░ рдЕрдЦрдВрдбрддрд╛

Resumability рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреЗ рдХреА рд▓рд╛рдВрдм-рдХрд╛рд▓рд╛рд╡рдзреАрдЪреЗ рдПрдЬрдВрдЯ рдХрд╛рд░реНрдп рдХреНрд▓рд╛рдпрдВрдЯ рдбрд┐рд╕рдХрдиреЗрдХреНрд╢рди рдЯрд┐рдХреВрди рд░рд╛рд╣рддреЗ рдЖрдгрд┐ рдкреБрдирд░реНрдХрдиреЗрдХреНрд╢рди рдЭрд╛рд▓реНрдпрд╛рд╡рд░ рдЕрдЦрдВрдбрдкрдгреЗ рд╕реБрд░реВ рдареЗрд╡рддреЗ. рд╣реЗ рдЗрд╡реНрд╣реЗрдВрдЯ рд╕реНрдЯреЛрдЕрд░реНрд╕ рдЖрдгрд┐ рдкреБрдирд░рд╛рд░рдВрдн рдЯреЛрдХрдирджреНрд╡рд╛рд░реЗ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рд┐рддреЗ.

**Event Store рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА (рд╕рд░реНрд╡реНрд╣рд░ рд╕рддреНрд░ рд╕реНрдерд┐рддреА рдареЗрд╡рддреЛ):**

```python
# From server/event_store.py - Simple in-memory event store
class SimpleEventStore(EventStore):
    def __init__(self):
        self._events: list[tuple[StreamId, EventId, JSONRPCMessage]] = []
        self._event_id_counter = 0

    async def store_event(self, stream_id: StreamId, message: JSONRPCMessage) -> EventId:
        """Store an event and return its ID."""
        self._event_id_counter += 1
        event_id = str(self._event_id_counter)
        self._events.append((stream_id, event_id, message))
        return event_id

    async def replay_events_after(self, last_event_id: EventId, send_callback: EventCallback) -> StreamId | None:
        """Replay events after the specified ID for resumption."""
        # Find events after the last known event and replay them
        for _, event_id, message in self._events[start_index:]:
            await send_callback(EventMessage(message, event_id))

# From server/server.py - Passing event store to session manager
def create_server_app(event_store: Optional[EventStore] = None) -> Starlette:
    server = ResumableServer()

    # Create session manager with event store for resumption
    session_manager = StreamableHTTPSessionManager(
        app=server,
        event_store=event_store,  # Event store enables session resumption
        json_response=False,
        security_settings=security_settings,
    )

    return Starlette(routes=[Mount("/mcp", app=session_manager.handle_request)])

# Usage: Initialize with event store
event_store = SimpleEventStore()
app = create_server_app(event_store)
```

**Client Metadata with Resumption Token (рдХреНрд▓рд╛рдпрдВрдЯ рд╕рд╛рдард╡рд▓реЗрд▓реНрдпрд╛ рд╕реНрдерд┐рддреАрдЪрд╛ рд╡рд╛рдкрд░ рдХрд░реВрди рдкреБрдиреНрд╣рд╛ рдХрдиреЗрдХреНрдЯ рд╣реЛрддреЛ):**

```python
# From client/client.py - Client resumption with metadata
if existing_tokens and existing_tokens.get("resumption_token"):
    # Use existing resumption token to continue where we left off
    metadata = ClientMessageMetadata(
        resumption_token=existing_tokens["resumption_token"],
    )
else:
    # Create callback to save resumption token when received
    def enhanced_callback(token: str):
        protocol_version = getattr(session, 'protocol_version', None)
        token_manager.save_tokens(session_id, token, protocol_version, command, args)

    metadata = ClientMessageMetadata(
        on_resumption_token_update=enhanced_callback,
    )

# Send request with resumption metadata
result = await session.send_request(
    types.ClientRequest(
        types.CallToolRequest(
            method="tools/call",
            params=types.CallToolRequestParams(name=command, arguments=args)
        )
    ),
    types.CallToolResult,
    metadata=metadata,
)
```

рд╣реЛрд╕реНрдЯ рдЕреЕрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдерд╛рдирд┐рдХрдкрдгреЗ рд╕рддреНрд░ IDs рдЖрдгрд┐ рдкреБрдирд░рд╛рд░рдВрдн рдЯреЛрдХрди рдареЗрд╡рддреЗ, рдЬреНрдпрд╛рдореБрд│реЗ рддреЗ рдкреНрд░рдЧрддреА рдХрд┐рдВрд╡рд╛ рд╕реНрдерд┐рддреА рди рдЧрдорд╛рд╡рддрд╛ рд╡рд┐рджреНрдпрдорд╛рди рд╕рддреНрд░рд╛рдВрд╢реА рдкреБрдиреНрд╣рд╛ рдХрдиреЗрдХреНрдЯ рд╣реЛрдК рд╢рдХрддреЗ.

### рдХреЛрдб рд╕рдВрдШрдЯрди

<div align="center" style="font-style: italic; font-size: 0.95em; margin-bottom: 0.5em;">
<strong>рдЪрд┐рддреНрд░ 5:</strong> MCP-рдЖрдзрд╛рд░рд┐рдд рдПрдЬрдВрдЯ рдкреНрд░рдгрд╛рд▓реА рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░
</div>

```mermaid
graph LR
    User([User]) -->|"Task"| Host["Host<br/>(MCP Client)"]
    Host -->|list tools| Server[MCP Server]
    Server -->|Exposes| AgentsTools[Agents as Tools]
    AgentsTools -->|Task| AgentA[Travel Agent]
    AgentsTools -->|Task| AgentB[Research Agent]

    Host -->|Monitors| StateUpdates[Progress & State Updates]
    Server -->|Publishes| StateUpdates

    class User user;
    class AgentA,AgentB agent;
    class Host,Server,StateUpdates core;
```

**рдореБрдЦреНрдп рдлрд╛рдЗрд▓реНрд╕:**

- **`server/server.py`** - Travel рдЖрдгрд┐ Research рдПрдЬрдВрдЯреНрд╕рд╕рд╣ рдкреБрдирд░рд╛рд░рдВрдн MCP рд╕рд░реНрд╡реНрд╣рд░ рдЬреЗ elicitation, sampling, рдЖрдгрд┐ рдкреНрд░рдЧрддреА рдЕрджреНрдпрддрдиреЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛рдд
- **`client/client.py`** - рдкреБрдирд░рд╛рд░рдВрдн рд╕рдорд░реНрдерди, callback handlers, рдЖрдгрд┐ рдЯреЛрдХрди рд╡реНрдпрд╡рд╕реНрдерд╛рдкрдирд╛рд╕рд╣ рд╕рдВрд╡рд╛рджрд╛рддреНрдордХ рд╣реЛрд╕реНрдЯ рдЕреЕрдкреНрд▓рд┐рдХреЗрд╢рди
- **`server/event_store.py`** - рд╕рддреНрд░ рдкреБрдирд░рд╛рд░рдВрдн рдЖрдгрд┐ рд╕рдВрджреЗрд╢ рдкреБрдирд░реНрдкреНрд░реЗрд╖рдг рд╕рдХреНрд╖рдо рдХрд░рдгрд╛рд░реЗ рдЗрд╡реНрд╣реЗрдВрдЯ рд╕реНрдЯреЛрдЕрд░ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА

## MCP рд╡рд░ рдорд▓реНрдЯреА-рдПрдЬрдВрдЯ рд╕рдВрд╡рд╛рджрд╛рд╕рд╛рдареА рд╡рд┐рд╕реНрддрд╛рд░

рд╡рд░реАрд▓ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рдгреА рд╣реЛрд╕реНрдЯ рдЕреЕрдкреНрд▓рд┐рдХреЗрд╢рдирдЪреА рдмреБрджреНрдзрд┐рдорддреНрддрд╛ рдЖрдгрд┐ рд╡реНрдпрд╛рдкреНрддреА рд╡рд╛рдврд╡реВрди рдорд▓реНрдЯреА-рдПрдЬрдВрдЯ рдкреНрд░рдгрд╛рд▓реАрдВрдордзреНрдпреЗ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХреЗрд▓реА рдЬрд╛рдК рд╢рдХрддреЗ:

- **Intelligent Task Decomposition**: рд╣реЛрд╕реНрдЯ рдЬрдЯрд┐рд▓ рд╡рд╛рдкрд░рдХрд░реНрддрд╛ рд╡рд┐рдирдВрддреНрдпрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рд┐рдд рдХрд░рддреЛ рдЖрдгрд┐ рд╡реЗрдЧрд╡реЗрдЧрд│реНрдпрд╛ рд╡рд┐рд╢реЗрд╖ рдПрдЬрдВрдЯреНрд╕рд╕рд╛рдареА рдЙрдкрдХрд╛рд░реНрдпрд╛рдВрдордзреНрдпреЗ рд╡рд┐рднрд╛рдЧрддреЛ
- **Multi-Server Coordination**: рд╣реЛрд╕реНрдЯ рдЕрдиреЗрдХ MCP рд╕рд░реНрд╡реНрд╣рд░реНрд╕рд╢реА рдХрдиреЗрдХреНрд╢рди рдареЗрд╡рддреЛ, рдкреНрд░рддреНрдпреЗрдХ рд╡реЗрдЧрд╡реЗрдЧрд│реНрдпрд╛ рдПрдЬрдВрдЯ рдХреНрд╖рдорддрд╛рдВрдЪрд╛ рдЙрдШрдбрдкрдгреЗ
- **Task State Management**: рд╣реЛрд╕реНрдЯ рдЕрдиреЗрдХ рд╕рдордХрд╛рд▓реАрди рдПрдЬрдВрдЯ рдХрд╛рд░реНрдпрд╛рдВрдордзреНрдпреЗ рдкреНрд░рдЧрддреА рдЯреНрд░реЕрдХ рдХрд░рддреЛ, рдЕрд╡рд▓рдВрдмрд┐рддреНрд╡реЗ рдЖрдгрд┐ рдЕрдиреБрдХреНрд░рдо рд╣рд╛рддрд╛рд│рддреЛ
- **Resilience & Retries**: рд╣реЛрд╕реНрдЯ рдЕрдкрдпрд╢ рд╣рд╛рддрд╛рд│рддреЛ, рдкреБрдирд░реНрдкреНрд░рдпрддреНрди рд▓реЙрдЬрд┐рдХ рдЕрдВрдорд▓рдмрдЬрд╛рд╡рддреЛ, рдЖрдгрд┐ рдПрдЬрдВрдЯреНрд╕ рдЕрдиреБрдкрд▓рдмреНрдз рдЭрд╛рд▓реНрдпрд╛рд╡рд░ рдХрд╛рд░реНрдп рдкреБрдирд░реНрдирд┐рд░реНрдж

---

**рдЕрд╕реНрд╡реАрдХрд░рдг**:  
рд╣рд╛ рджрд╕реНрддрдРрд╡рдЬ AI рднрд╛рд╖рд╛рдВрддрд░ рд╕реЗрд╡рд╛ [Co-op Translator](https://github.com/Azure/co-op-translator) рдЪрд╛ рд╡рд╛рдкрд░ рдХрд░реВрди рднрд╛рд╖рд╛рдВрддрд░рд┐рдд рдХрд░рдгреНрдпрд╛рдд рдЖрд▓рд╛ рдЖрд╣реЗ. рдЖрдореНрд╣реА рдЕрдЪреВрдХрддреЗрд╕рд╛рдареА рдкреНрд░рдпрддреНрдирд╢реАрд▓ рдЕрд╕рд▓реЛ рддрд░реА, рдХреГрдкрдпрд╛ рд▓рдХреНрд╖рд╛рдд рдШреНрдпрд╛ рдХреА рд╕реНрд╡рдпрдВрдЪрд▓рд┐рдд рднрд╛рд╖рд╛рдВрддрд░рд╛рдВрдордзреНрдпреЗ рддреНрд░реБрдЯреА рдХрд┐рдВрд╡рд╛ рдЕрдЪреВрдХрддреЗрдЪрд╛ рдЕрднрд╛рд╡ рдЕрд╕реВ рд╢рдХрддреЛ. рдореВрд│ рднрд╛рд╖реЗрддреАрд▓ рджрд╕реНрддрдРрд╡рдЬ рд╣рд╛ рдЕрдзрд┐рдХреГрдд рд╕реНрд░реЛрдд рдорд╛рдирд▓рд╛ рдЬрд╛рд╡рд╛. рдорд╣рддреНрддреНрд╡рд╛рдЪреНрдпрд╛ рдорд╛рд╣рд┐рддреАрд╕рд╛рдареА рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдорд╛рдирд╡реА рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪреА рд╢рд┐рдлрд╛рд░рд╕ рдХреЗрд▓реА рдЬрд╛рддреЗ. рдпрд╛ рднрд╛рд╖рд╛рдВрддрд░рд╛рдЪрд╛ рд╡рд╛рдкрд░ рдХреЗрд▓реНрдпрд╛рдореБрд│реЗ рдЙрджреНрднрд╡рдгрд╛рд▒реНрдпрд╛ рдХреЛрдгрддреНрдпрд╛рд╣реА рдЧреИрд░рд╕рдордЬ рдХрд┐рдВрд╡рд╛ рдЪреБрдХреАрдЪреНрдпрд╛ рдЕрд░реНрдерд╛рд╕рд╛рдареА рдЖрдореНрд╣реА рдЬрдмрд╛рдмрджрд╛рд░ рд░рд╛рд╣рдгрд╛рд░ рдирд╛рд╣реА.